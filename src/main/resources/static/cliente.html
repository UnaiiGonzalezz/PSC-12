<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lista de clientes</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<nav>
  <a href="index.html">Catálogo</a>
  <a href="cliente.html">Clientes</a>
  <a href="compra.html">Ver compra</a>
  <a href="nueva-compra.html">Nueva compra</a>
  <a href="admin.html">Admin</a>
</nav>

<h1>Clientes registrados</h1>

<table>
  <thead>
    <tr><th>Nombre</th><th>Apellido</th><th>Email</th><th>Método de Pago</th><th>Rol</th></tr>
  </thead>
  <tbody id="tbody"></tbody>
</table>

<button class="logout-button" onclick="logout()">Cerrar sesión</button>

<script>
const token = sessionStorage.getItem('token');
if (!token) {
  window.location.href = 'login.html';
}

function logout() {
  sessionStorage.removeItem('token');
  sessionStorage.removeItem('rol');
  window.location.href = 'login.html';
}

fetch('/api/cliente', {
  headers: { 'Authorization': 'Bearer ' + token }
})
.then(r => r.json())
.then(clientes => {
  const rows = clientes.map(c =>
    `<tr>
       <td>${c.nombre}</td>
       <td>${c.apellido}</td>
       <td>${c.email}</td>
       <td>${c.metodoPago}</td>
       <td>${c.rol}</td>
     </tr>`).join('');
  document.getElementById('tbody').innerHTML = rows;
})
.catch(() => alert('No se pudieron cargar los clientes.'));
</script>

</body>
</html>
