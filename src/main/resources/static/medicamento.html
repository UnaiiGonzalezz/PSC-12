<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Detalle de Medicamento</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<nav>
  <a href="index.html">Catálogo</a>
 
  <a href="compra.html">Ver compra</a>
  <a href="nueva-compra.html">Nueva compra</a>
  <a href="admin.html">Admin</a>
</nav>

<a href="index.html" class="volver">← Volver al catálogo</a>
<h1 id="titulo"></h1>

<ul id="info" class="detalle"></ul>

<button class="logout-button" onclick="logout()">Cerrar sesión</button>

<script>
const token = sessionStorage.getItem('token');
if (!token) {
  window.location.href = 'login.html';
}

function logout() {
  sessionStorage.removeItem('token');
  sessionStorage.removeItem('rol');
  window.location.href = 'login.html';
}

const id = new URLSearchParams(location.search).get('id');

fetch(`/medicamentos/${id}`, {
  headers: { 'Authorization': 'Bearer ' + token }
})
.then(r => r.json())
.then(m => {
  document.getElementById('titulo').textContent = m.nombre;
  document.getElementById('info').innerHTML = `
    <li><strong>Categoría:</strong> ${m.categoria}</li>
    <li><strong>Precio:</strong> €${m.precio.toFixed(2)}</li>
    <li><strong>Stock:</strong> ${m.stock}</li>
    <li><strong>Proveedor:</strong> ${m.proveedor}</li>
    <li><strong>Disponible:</strong> ${m.disponible ? 'Sí' : 'No'}</li>`;
})
.catch(() => document.body.innerHTML = '<p class="error">Medicamento no encontrado.</p>');
</script>

</body>
</html>
