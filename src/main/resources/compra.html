<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Detalle de compra</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <nav>
    <a href="index.html">Catálogo</a> |
    <a href="cliente.html">Clientes</a> |
    <a href="compra.html">Ver compra</a> |
    <a href="nueva-compra.html">Nueva compra</a> |
    <a href="admin.html">Admin</a>
  </nav>

  <h1>Detalle de la compra</h1>

  <form onsubmit="verCompra(); return false;">
    <label>ID de la compra:</label>
    <input type="number" id="idCompra" required>
    <button type="submit">Buscar</button>
  </form>

  <ul id="detalle" class="detalle"></ul>

  <script>
    function verCompra() {
      const id = document.getElementById('idCompra').value;
      fetch(`/compras/${id}`)
        .then(r => {
          if (!r.ok) throw new Error();
          return r.json();
        })
        .then(c => {
          document.getElementById('detalle').innerHTML = `
            <li><strong>Cliente:</strong> ${c.cliente.nombre} ${c.cliente.apellido}</li>
            <li><strong>Medicamentos:</strong> ${c.medicamentos.map(m => m.nombre).join(', ')}</li>
            <li><strong>Cantidad:</strong> ${c.cantidad}</li>
            <li><strong>Pago:</strong> €${c.pago.toFixed(2)}</li>
            <li><strong>Estado:</strong> ${c.estado}</li>
            <li><strong>Método de pago:</strong> ${c.metodoPago}</li>
            <li><strong>Fecha de compra:</strong> ${c.fechaCompra}</li>`;
        })
        .catch(() => document.getElementById('detalle').innerHTML = '<li>Compra no encontrada.</li>');
    }
  </script>
</body>
</html>